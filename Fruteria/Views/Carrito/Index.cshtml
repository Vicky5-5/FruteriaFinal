@model IEnumerable<Fruteria.ViewModels.ProductosViewModel>

@{
    ViewBag.Title = "Index";
}
<!--HACER AQUÍ UNA OPCIÓN PARA HACER LOGOUT-->

<h2>Realizando Compra</h2>
<p>
    <h6>
        <strong>Usuario</strong>: @ViewBag.Usuario
    </h6>
</p>
<h2>CATÁLOGO</h2>
<div class="card">
    <table class="table">
        <thead>
            <tr>

                <th>
                    Nombre del Producto
                </th>
                <th>
                    Precio
                </th>
                <th>
                    Stock
                </th>
                <th>
                    Descripción
                </th>
                <th>
                    Oferta
                </th>
                <th>
                    Origen
                </th>
                <th>
                    En Temporada
                </th>
                <th>
                    Categoría
                </th>
                <th>
                    Imagen
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {

                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.NombreProducto)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Precio)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Stock)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Descripcion)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Oferta)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Origen)
                    </td>
                    <td>
                        @(item.EnTemporada ? "Sí" : "No")

                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Categoria)
                    </td>
                    <td>
                        <img src="@item.ImagenURL" width="100" height="100" alt="Imagen del producto" />
                    </td>
                    <td>
                        @Html.ActionLink("Añadir Carrito", "AddToCart", "Carrito")
                    </td>

                </tr>
            }
        </tbody>
    </table>
</div>
@Html.ActionLink("Log Out", "LogOut", "Login")


<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>


    $(document).ready(function () {
        var clicks = 0;
        //Jugar con un remove de la cantidad o un substract
        function onClick() {
            clicks += 1;
            document.getElementById("clicks").innerHTML = clicks;
        };
        $("#agregar").clicks(function () {
            clicks

            var url = '@Url.Action("ListaCompras", "Carrito")'; //Insertar aquí para realizar compra. Con el controller y demás
            var vuelta = '@Url.Action("Index", "Carrito")';

            $.ajax({
                url: url,
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(datosRetiro),
                success: function (response) {
                    if (response.success) {
                        alert("Compra realizada");
                        window.location.href = vuelta;

                    } else {
                        alert("Error: " + response.message);
                    }
                },
                error: function (xhr, status, error) {
                    alert("Error al retirar: " + xhr.responseText);
                }
            });
        });

    });
</script>
<style>
    #boton {
        border-radius: 5px;
        color: white;
    }
</style>